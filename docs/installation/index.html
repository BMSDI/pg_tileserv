<!DOCTYPE html>
<html>
  <head>
    
    <title>pg_tileserv</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.64.1" />
<title>Installation :: pg_tileserv</title>
<link rel="shortcut icon" href="../favicon.png" type="image/x-icon" />
<link href="../css/nucleus.css" rel="stylesheet">
<link href="../theme-flex/style.css" rel="stylesheet">

<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
<link href="../css/Fort-Fonts.css" rel="stylesheet">
<link href="../css/custom.css" rel="stylesheet">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
<script src="../js/jquery-2.x.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.bundle.min.js" integrity="sha384-zDnhMsjVZfS3hiP7oCBRmfjkQC4fzxVxFhBx8Hkz2aZX8gEvA/jsP3eXRCvzTofP" crossorigin="anonymous"></script>
<script src="../js/main.js"></script>
<script src="../js/toc.js"></script>
<script type="text/javascript">
      var baseurl = "https:\/\/pramsey.github.io\/pg_tileserv";
</script>
<meta name="description" content="">



    
  </head>
  <body data-url="/installation/">
    
      <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
  
<a class="navbar-brand" href="https://www.crunchydata.com/"><img alt="Crunchy Data" src="../images/logo.svg"></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <ul class="navbar-nav mr-auto"></ul>
  <span class="navbar-text">
  </span>
</nav>

<article>
  <aside>

    <ul class="menu">
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="">
        </div>
        <script type="text/javascript" src="../js/lunr.min.js"></script>
        <script type="text/javascript" src="../js/auto-complete.js"></script>
        <link href="../css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "https:\/\/pramsey.github.io\/pg_tileserv";
          
        </script>
        <script type="text/javascript" src="../js/search.js"></script>
      </div>

      <hr>
      <a class="baselink" href="../">pg_tileserv</a>
      <hr>

      <b>Navigation</b>
          <li data-nav-id="/" class="dd-item">
          <a href="../">
            Home
          </a>
          </li>
    <li data-nav-id="https://pramsey.github.io/pg_tileserv/introduction/" class="dd-item
        ">
      <div>
      <a href="../introduction/">About pg_tileserv</a>

      </div>
    </li>
    <li data-nav-id="https://pramsey.github.io/pg_tileserv/installation/" class="dd-item parent active
        ">
      <div>
      <a href="../installation/">Installation</a>

      </div>
    </li>
    <li data-nav-id="https://pramsey.github.io/pg_tileserv/usage/" class="dd-item haschildren
        ">
      <div>
      <a href="../usage/">Usage</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://pramsey.github.io/pg_tileserv/usage/metadata/" class="dd-item">
        <div>
          <a href="../usage/metadata/">
            Service Metadata
          </a>
        </div>
    </li>
      <li data-nav-id="https://pramsey.github.io/pg_tileserv/usage/table-layers/" class="dd-item">
        <div>
          <a href="../usage/table-layers/">
            Table Layers
          </a>
        </div>
    </li>
      <li data-nav-id="https://pramsey.github.io/pg_tileserv/usage/function-layers/" class="dd-item">
        <div>
          <a href="../usage/function-layers/">
            Function Layers
          </a>
        </div>
    </li>
      <li data-nav-id="https://pramsey.github.io/pg_tileserv/usage/function-layers-advanced/" class="dd-item">
        <div>
          <a href="../usage/function-layers-advanced/">
            Advanced Function Layers
          </a>
        </div>
    </li>
      <li data-nav-id="https://pramsey.github.io/pg_tileserv/usage/security/" class="dd-item">
        <div>
          <a href="../usage/security/">
            Security
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://pramsey.github.io/pg_tileserv/examples/" class="dd-item haschildren
        ">
      <div>
      <a href="../examples/">Examples</a><i class="fas fa-angle-right fa-lg category-icon"></i>

      </div>
        <ul>
      <li data-nav-id="https://pramsey.github.io/pg_tileserv/examples/example-openlayers/" class="dd-item">
        <div>
          <a href="../examples/example-openlayers/">
            OpenLayers Example
          </a>
        </div>
    </li>
      <li data-nav-id="https://pramsey.github.io/pg_tileserv/examples/example-mapbox-gl-js/" class="dd-item">
        <div>
          <a href="../examples/example-mapbox-gl-js/">
            Mapbox GL JS Example
          </a>
        </div>
    </li>
      <li data-nav-id="https://pramsey.github.io/pg_tileserv/examples/example-leaflet/" class="dd-item">
        <div>
          <a href="../examples/example-leaflet/">
            Leaflet Example
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://pramsey.github.io/pg_tileserv/learn-more/" class="dd-item
        ">
      <div>
      <a href="../learn-more/">Learn More</a>

      </div>
    </li>
    <li data-nav-id="https://pramsey.github.io/pg_tileserv/troubleshooting/" class="dd-item
        ">
      <div>
      <a href="../troubleshooting/">Troubleshooting</a>

      </div>
    </li>




      <hr><nav id="TableOfContents"></nav>



      <section>
      </section>
    </ul>
  </aside>
  <section class="page">

    <div class="nav-select">
      <center>Navigation :
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/introduction/" >
   About pg_tileserv</option>
    <option value="/installation/"  selected>
   Installation</option> 
  
    <option value="/usage/" >
   Usage</option>
    <option value="/examples/" >
   Examples</option>
    <option value="/learn-more/" >
   Learn More</option>
    <option value="/troubleshooting/" >
   Troubleshooting</option>



        </select>
      </center>
    </div>

    
      <div id="top-bar">
        
          
          
          
        <div id="top-github-link">
          <a class="github-link" href="../contributing/" target="blank">
            <i class="fa fa-info-circle"></i>
            
          </a>
          <a class="github-link" href="https://github.com/CrunchyData/pg_tileservinstallation/_index.md" target="blank">
            <i class="fa fa-code-fork"></i>
            
          </a>
        </div><div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                <i class="fa fa-bars"></i>
              </a>
            </span>
            <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
            <span class="links">
            




 <a href='https://pramsey.github.io/pg_tileserv/'>pg_tileserv</a> > Installation

 


            </span>
        </div>

      </div>
    

    
    <div id="body-inner">

    <h1>Installation</h1>

    

    

<h2 id="requirements">Requirements</h2>
<ul>
<li><strong>PostgreSQL 9.5</strong> or later</li>
<li><strong>PostGIS 2.4</strong> or later</li>
</ul>
<p>The tile server depends on the <a href="https://postgis.net/docs/ST_AsMVT.html">ST_AsMVT()</a> function, which is only available if PostGIS has been compiled with support for the <strong>libprotobuf</strong> library. See the output from <a href="https://postgis.net/docs/PostGIS_Full_Version.html">PostGIS_Full_Version</a>, for example:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#00a8c8">SELECT</span> <span style="color:#111">postgis_full_version</span><span style="color:#111">(</span><span style="color:#111">)</span>
</code></pre></div><pre><code>POSTGIS=&quot;3.0.1&quot; [EXTENSION] PGSQL=&quot;121&quot; GEOS=&quot;3.8.0-CAPI-1.13.1 &quot;
PROJ=&quot;6.1.0&quot; LIBXML=&quot;2.9.4&quot; LIBJSON=&quot;0.13&quot;
LIBPROTOBUF=&quot;1.3.2&quot; WAGYU=&quot;0.4.3 (Internal)&quot;
</code></pre><h2 id="installation">Installation</h2>
<p>To install <code>pg_tileserv</code>, download the binary file. Alternatively, you may run a container, or build the executable from source.</p>
<h3 id="a-download-binaries">A. Download Binaries</h3>
<p>Builds of the latest code:</p>
<ul>
<li><a href="https://postgisftw.s3.amazonaws.com/pg_tileserv_latest_linux.zip">Linux</a></li>
<li><a href="https://postgisftw.s3.amazonaws.com/pg_tileserv_latest_windows.zip">Windows</a></li>
<li><a href="https://postgisftw.s3.amazonaws.com/pg_tileserv_latest_osx.zip">OSX</a></li>
</ul>
<p>Unzip the file, copy the <code>pg_tileserv</code> binary wherever you wish, or use it in place. If you move the binary, remember to move the <code>assets/</code> directory to the same location, or start the server using the <code>AssetsDir</code> configuration option.</p>
<h3 id="b-run-container">B. Run Container</h3>
<p>There is a docker image available on DockerHub.</p>
<ul>
<li><a href="https://hub.docker.com/repository/docker/pramsey/pg_tileserv">Docker</a></li>
</ul>
<p>Run the container, provide database connection information in the <code>DATABASE_URL</code> environment variable and map the default service port (7800).</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">docker run -e <span style="color:#111">DATABASE_URL</span><span style="color:#f92672">=</span>postgres://user:pass@host/dbname -p 7800:7800 pramsey/pg_tileserv
</code></pre></div><h3 id="c-build-from-source">C. Build From Source</h3>
<p>Install the <a href="https://golang.org/doc/install">Go software development environment</a>. Make sure that the <a href="https://github.com/golang/go/wiki/SettingGOPATH"><code>GOPATH</code> environment variable</a> is also set.</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#111">SRC</span><span style="color:#f92672">=</span><span style="color:#111">$GOPATH</span>/src/github.com/CrunchyData
mkdir -p <span style="color:#111">$SRC</span>
<span style="color:#111">cd</span> <span style="color:#111">$SRC</span>
git clone git@github.com:CrunchyData/pg_tileserv.git
<span style="color:#111">cd</span> pg_tileserv
go build
go install
</code></pre></div><p>To run the build, set the <code>DATABASE_URL</code> environment variable to the database you want to connect to, and run the binary.</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#111">export</span> <span style="color:#111">DATABASE_URL</span><span style="color:#f92672">=</span>postgres://user:pass@host/dbname
<span style="color:#111">$GOPATH</span>/bin/pg_tileserv
</code></pre></div><h2 id="deployment">Deployment</h2>
<h3 id="basic-operation">Basic Operation</h3>
<h4 id="linuxosx">Linux/OSX</h4>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#111">export</span> <span style="color:#111">DATABASE_URL</span><span style="color:#f92672">=</span>postgresql://username:password@host/dbname
./pg_tileserv
</code></pre></div><h4 id="windows">Windows</h4>
<pre><code>SET DATABASE_URL=postgresql://username:password@host/dbname
pg_tileserv.exe
</code></pre><h3 id="configuration-file">Configuration File</h3>
<p>The configuration file will be automatically read from the following locations, if it exists:</p>
<ul>
<li>In the system configuration directory, at <code>/etc/pg_tileserv.toml</code></li>
<li>Relative to the directory from which the program is run, <code>./pg_tileserv.toml</code></li>
</ul>
<p>If you want to pass a path directly to the configuration file, use the <code>--config</code> commandline parameter to pass in a pull path to configuration file. When using the <code>--config</code> option, configuration files in other locations will be ignored.</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">./pg_tileserv --config /opt/pg_tileserv/pg_tileserv.toml
</code></pre></div><p>In general the defaults are fine, and the program autodetects things like the server name.</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml"><span style="color:#75715e"># Database connection</span>
<span style="color:#75af00">DbConnection</span> <span style="color:#111">=</span> <span style="color:#d88200">&#34;user=you host=localhost dbname=yourdb&#34;</span>
<span style="color:#75715e"># Close pooled connections after this interval</span>
<span style="color:#75af00">DbPoolMaxConnLifeTime</span> <span style="color:#111">=</span> <span style="color:#d88200">&#34;1h&#34;</span>
<span style="color:#75715e"># Hold no more than this number of connections in the database pool</span>
<span style="color:#75af00">DbPoolMaxConns</span> <span style="color:#111">=</span> <span style="color:#ae81ff">4</span>
<span style="color:#75715e"># Look to read html templates from this directory</span>
<span style="color:#75af00">AssetsPath</span> <span style="color:#111">=</span> <span style="color:#d88200">&#34;./assets&#34;</span>
<span style="color:#75715e"># Accept connections on this subnet (default accepts on all subnets)</span>
<span style="color:#75af00">HttpHost</span> <span style="color:#111">=</span> <span style="color:#d88200">&#34;0.0.0.0&#34;</span>
<span style="color:#75715e"># Accept connections on this port</span>
<span style="color:#75af00">HttpPort</span> <span style="color:#111">=</span> <span style="color:#ae81ff">7800</span>
<span style="color:#75715e"># Advertise URLs relative to this server name</span>
<span style="color:#75715e"># default is to look this up from incoming request headers</span>
<span style="color:#75715e"># UrlBase = &#34;http://yourserver.com/&#34;</span>
<span style="color:#75715e"># Resolution to quantize vector tiles to</span>
<span style="color:#75af00">DefaultResolution</span> <span style="color:#111">=</span> <span style="color:#ae81ff">4096</span>
<span style="color:#75715e"># Rendering buffer to add to vector tiles</span>
<span style="color:#75af00">DefaultBuffer</span> <span style="color:#111">=</span> <span style="color:#ae81ff">256</span>
<span style="color:#75715e"># Limit number of features requested (-1 = no limit)</span>
<span style="color:#75af00">MaxFeaturesPerTile</span> <span style="color:#111">=</span> <span style="color:#ae81ff">10000</span>
<span style="color:#75715e"># Advertise this minimum zoom level</span>
<span style="color:#75af00">DefaultMinZoom</span> <span style="color:#111">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#75715e"># Advertise this maximum zoom level</span>
<span style="color:#75af00">DefaultMaxZoom</span> <span style="color:#111">=</span> <span style="color:#ae81ff">22</span>
<span style="color:#75715e"># Output extra logging information?</span>
<span style="color:#75af00">Debug</span> <span style="color:#111">=</span> <span style="color:#00a8c8">false</span>
</code></pre></div>



    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="https://pramsey.github.io/pg_tileserv/introduction/" title="About pg_tileserv"> <i class="fa fa-chevron-left"></i><label>About pg_tileserv</label></a>
    <a class="nav nav-next" href="https://pramsey.github.io/pg_tileserv/usage/" title="Usage" style="margin-right: 0px;"><label>Usage</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

  

  </div>


	<div>
	</div>
</footer>

<link href="../css/featherlight.min.css" rel="stylesheet">
<script src="../js/featherlight.min.js"></script>

<script src="../theme-flex/script.js"></script>


    

    
    

    
  </body>
</html>
